<form name="postFiltersFormOpen"
      uib-dropdown
      is-open="status.isopen"
      role="search"
      class="searchbar"
      auto-close="disabled"
      ng-submit="applyFilters()"
      ng-model-options="{ updateOn : 'submit default' }"
      data-message="search"
      ng-class="{ active: status.isopen }"
>

    <div class="searchbar-input">
        <!-- Search input -->
        <div class="form-field">
            <label class="hidden" translate="toolbar.searchbar.search_entity">Search</label>
            <div class="input-with-icon">
                <input
                    name="q"
                    type="search"
                    autocomplete="off"
                    placeholder="{{ 'toolbar.searchbar.search_entity' | translate }}"
                    ng-model="filters.q"
                    ng-model-options="{debounce: 300}"
                    ng-click = "toggleDropdown($event)"
                    ng-keyup="toggleDropdown($event)"
                    ng-keypress="toggleDropdown($event)"
                >
                <svg class="iconic" role="img" ng-show="!postFiltersFormOpen.q.$viewValue.length">
                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/img/iconic-sprite.svg#magnifying-glass"></use>
                </svg>
                <svg class="iconic" role="img" ng-click="removeQueryFilter()" ng-show="postFiltersFormOpen.q.$viewValue.length">
                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/img/iconic-sprite.svg#circle-x"></use>
                </svg>
            </div>
        </div>
    </div>


    <!-- Toggle Filters show/hide -->
    <div uib-dropdown-toggle class="searchbar-options">
        <button class="searchbar-options-filter button">
            <sort-and-filter-counter></sort-and-filter-counter>
        </button>
    </div>

    <filters-dropdown stats="stats" uib-dropdown-menu class="dropdown-menu" dropdown-status="status" filters="filters"></filters-dropdown>
</form>
