<form name="postFiltersFormOpen"
      uib-dropdown
      is-open="status.isopen"
      role="search"
      class="searchbar"
      auto-close="disabled"
      ng-submit="applyFilters()"
      ng-model-options="{ updateOn : 'submit default' }"
      data-message="search"
      ng-class="{ active: status.isopen }"
>

    <div class="searchbar-input">
        <!-- Search input -->
        <div class="form-field">
            <label class="hidden" translate="toolbar.searchbar.search_entity">Search</label>
            <div class="input-with-icon">
                <input name="q" type="search" autocomplete="off"
                placeholder="{{ 'toolbar.searchbar.search_entity' | translate }}"
                ng-model="filters.q" ng-model-options="{ debounce: 300 }" ng-click = "showDropdown()" ng-keyup="($event.keyCode === 27)  ? hideDropdown(): showDropdown()" ng-keypress="($event.keyCode === 27) ? hideDropdown(): showDropdown()">
                <svg class="iconic" ng-show="!postFiltersFormOpen.q.$viewValue.length">
                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/img/iconic-sprite.svg#magnifying-glass"></use>
                </svg>
                <svg class="iconic" ng-click="removeQueryFilter()" ng-show="postFiltersFormOpen.q.$viewValue.length">
                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/img/iconic-sprite.svg#circle-x"></use>
                </svg>
            </div>
        </div>
    </div>


    <!-- Toggle Filters show/hide -->
    <div uib-dropdown-toggle class="searchbar-options">
        <a type="button" class="searchbar-options-filter button">
            <sort-and-filter-counter></sort-and-filter-counter>
        </a>
    </div>

    <filters-dropdown uib-dropdown-menu class="dropdown-menu" dropdown-status="status" filters="filters"></filters-dropdown>
</form>
